!function(){function e(t){let{logger:r=console.log.bind(console),ready:n}=t;e.path;let o=new Worker(new URL("http://localhost:3000/qpdf-worker.js"));console.log("new worker",o);let a={},l=0,u=function(e,t){a[e]=t,l+=1},f=function(e,t,r){let n=a[e];n&&(delete a[e],n(t,r)),0==(l-=1)&&setTimeout(function(){null!==o&&0===l&&(console.log("worker terminated"),o.terminate(),o=null)},1e3)},s={save(e,t,r){if(!o)return r(Error("worker terminated"));u(e,r),o.postMessage({type:"save",filename:e,arrayBuffer:t})},load(e,t){if(!o)return t(Error("worker terminated"));u(e,t),o.postMessage({type:"load",filename:e})},execute(e,t){if(!o)return t(Error("worker terminated"));u("execute",t),o.postMessage({type:"execute",args:e})}};o.onmessage=function(e){let t=e.data;switch(t.type){case"ready":r("[qpdf] ready"),n&&n(s);break;case"stdout":r("[qpdf.worker] "+t.line);break;case"saved":{let e=t.filename;r("[qpdf] "+e+" saved"),f(e,null);break}case"loaded":{let{filename:e,arrayBuffer:n}=t;r("[qpdf] "+e+" loaded ("+n.length+")"),n?f(e,null,n):f(e,Error("File not found"));break}case"executed":{let{status:e}=t;r("[qpdf] exited with status "+e),0!==e?f("execute",Error("QPDF exited with status "+e)):f("execute",null);break}default:r("[qpdf] other message "+t)}}}e.encrypt=function({logger:t,arrayBuffer:r,userPassword:n,ownerPassword:o,keyLength:a,callback:l}){let u=function(e,t){l&&(e||t)&&(l(e,t),l=null)};e({logger:t,ready:function(e){e.save("input.pdf",r,u),e.execute(["--encrypt",n||"",o||"",String(a||256),"--","input.pdf","output.pdf"],u),e.load("output.pdf",u)}})},e.help=function(t){e({logger:t,ready:function(e){e.execute(["--help"])}})},e.base64ToArrayBuffer=function(e){let t=window.atob(e),r=t.length,n=new Uint8Array(r);for(let e=0;e<r;e++)n[e]=t.charCodeAt(e);return n.buffer},e.arrayBufferToBase64=function(e){let t="",r=new Uint8Array(e),n=r.byteLength;for(let e=0;e<n;e++)t+=String.fromCharCode(r[e]);return window.btoa(t)},window.QPDF=e}();
//# sourceMappingURL=index.e26b6674.js.map
